{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/PC/Documents/GIT%20Projects/Spenda/app/api/aliexpress/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\n\r\n// Server-side AliExpress API integration\r\nexport async function GET(request: NextRequest) {\r\n  const { searchParams } = new URL(request.url);\r\n  const query = searchParams.get('q');\r\n  const maxResults = parseInt(searchParams.get('limit') || '20');\r\n\r\n  if (!query) {\r\n    return NextResponse.json({ error: 'Query parameter is required' }, { status: 400 });\r\n  }\r\n\r\n  try {\r\n    // Option 1: Using RapidAPI AliExpress Scraper\r\n    if (process.env.RAPIDAPI_KEY) {\r\n      const response = await fetch('https://aliexpress-scraper.p.rapidapi.com/search', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'X-RapidAPI-Key': process.env.RAPIDAPI_KEY,\r\n          'X-RapidAPI-Host': 'aliexpress-scraper.p.rapidapi.com'\r\n        },\r\n        body: JSON.stringify({\r\n          query: query,\r\n          page: 1,\r\n          maxResults: maxResults\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`API request failed: ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      \r\n      // Transform the response to match our Product interface\r\n      const products = (data.products || []).map((item: any, index: number) => ({\r\n        id: item.productId || `aliexpress-${index}`,\r\n        name: item.title || item.productTitle,\r\n        price: parseFloat(item.price?.replace(/[^0-9.]/g, '') || '0'),\r\n        currency: item.currency || 'USD',\r\n        rating: parseFloat(item.rating || '0'),\r\n        reviews: parseInt(item.orders || item.reviewCount || '0'),\r\n        shipping: item.shipping || 'Standard shipping',\r\n        inStock: item.available !== false,\r\n        imageUrl: item.imageUrl || item.thumbnail,\r\n        source: 'aliexpress',\r\n        originalUrl: item.productUrl,\r\n        description: item.description\r\n      }));\r\n\r\n      return NextResponse.json({ products, source: 'api' });\r\n    }\r\n\r\n    // Option 2: Mock data fallback\r\n    const mockProducts = [\r\n      {\r\n        id: 'ae-001',\r\n        name: `${query} - Professional Quality`,\r\n        price: 15.99,\r\n        currency: 'USD',\r\n        rating: 4.3,\r\n        reviews: 2847,\r\n        shipping: 'Free shipping',\r\n        inStock: true,\r\n        source: 'aliexpress',\r\n        description: 'High-quality product with fast shipping from verified seller'\r\n      },\r\n      {\r\n        id: 'ae-002',\r\n        name: `${query} - Premium Edition with Accessories`,\r\n        price: 28.50,\r\n        currency: 'USD',\r\n        rating: 4.6,\r\n        reviews: 1523,\r\n        shipping: '7-15 days',\r\n        inStock: true,\r\n        source: 'aliexpress',\r\n        description: 'Complete set with all accessories included'\r\n      },\r\n      {\r\n        id: 'ae-003',\r\n        name: `${query} - Wholesale Pack (5 pieces)`,\r\n        price: 45.00,\r\n        currency: 'USD',\r\n        rating: 4.1,\r\n        reviews: 893,\r\n        shipping: '10-20 days',\r\n        inStock: true,\r\n        source: 'aliexpress',\r\n        description: 'Bulk purchase option with significant savings'\r\n      },\r\n      {\r\n        id: 'ae-004',\r\n        name: `${query} - Budget Friendly Option`,\r\n        price: 8.99,\r\n        currency: 'USD',\r\n        rating: 3.9,\r\n        reviews: 1247,\r\n        shipping: 'Standard shipping',\r\n        inStock: true,\r\n        source: 'aliexpress',\r\n        description: 'Affordable option without compromising quality'\r\n      },\r\n      {\r\n        id: 'ae-005',\r\n        name: `${query} - Limited Edition`,\r\n        price: 42.99,\r\n        currency: 'USD',\r\n        rating: 4.8,\r\n        reviews: 567,\r\n        shipping: 'Express 5-7 days',\r\n        inStock: false,\r\n        source: 'aliexpress',\r\n        description: 'Special limited edition with unique features'\r\n      }\r\n    ].slice(0, maxResults);\r\n\r\n    return NextResponse.json({ products: mockProducts, source: 'mock' });\r\n\r\n  } catch (error) {\r\n    console.error('AliExpress API error:', error);\r\n    \r\n    // Return error response\r\n    return NextResponse.json(\r\n      { error: 'Failed to fetch AliExpress products', details: error instanceof Error ? error.message : 'Unknown error' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}